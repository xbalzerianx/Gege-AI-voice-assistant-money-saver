<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gege - AI Money Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src='https://unpkg.com/tesseract.js@4.1.1/dist/tesseract.min.js'></script>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Nunito', sans-serif; }
        body { background: #F5E6C8; }
        .phone { width: 375px; height: 812px; background: #FFFBF0; border-radius: 45px; box-shadow: 0 25px 60px rgba(0,0,0,0.2), 0 0 0 12px #1a1a1a; overflow: hidden; position: relative; margin: 0 auto; }
        .screen { width: 100%; height: 100%; overflow-y: auto; background: #FFFBF0; }
        .screen::-webkit-scrollbar { display: none; }
        .card { border-radius: 24px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        .nav { position: absolute; bottom: 20px; left: 20px; right: 20px; height: 70px; background: #1a1a1a; border-radius: 35px; display: flex; justify-content: space-around; align-items: center; }
        .nav-item { width: 50px; height: 50px; border-radius: 16px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s; }
        .nav-item.active { background: #F4D03F; }
        .nav-item.active svg { color: #1a1a1a; }
        .nav-item:not(.active) svg { color: #888; }
        .page { display: none; padding: 20px; padding-bottom: 120px; }
        .page.active { display: block; }
        .avatar { width: 44px; height: 44px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 16px; color: white; border: 3px solid white; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .badge-sent { background: #FFB6C1; color: #C71585; padding: 4px 12px; border-radius: 16px; font-weight: 700; font-size: 12px; }
        .badge-received { background: #90EE90; color: #228B22; padding: 4px 12px; border-radius: 16px; font-weight: 700; font-size: 12px; }
        .btn-mic { background: linear-gradient(135deg, #F4D03F 0%, #F7DC6F 100%); color: #1a1a1a; width: 70px; height: 70px; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 6px 20px rgba(244, 208, 63, 0.5); }
        .btn-camera { background: linear-gradient(135deg, #E8A0BF 0%, #F5B7D3 100%); color: white; width: 70px; height: 70px; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 6px 20px rgba(232, 160, 191, 0.5); }
        @keyframes pulse-ring { 0% { transform: scale(1); opacity: 0.8; } 100% { transform: scale(1.6); opacity: 0; } }
        .voice-ring { position: absolute; width: 140px; height: 140px; border-radius: 50%; background: #F4D03F; animation: pulse-ring 1.5s infinite; }
        .modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 100; justify-content: center; align-items: flex-end; }
        .modal.active { display: flex; }
        .modal-content { background: #FFFBF0; border-radius: 30px 30px 0 0; width: 100%; max-height: 85%; overflow-y: auto; padding: 24px; }
        .ocr-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(26,26,26,0.95); z-index: 150; display: none; flex-direction: column; align-items: center; justify-content: center; }
        .ocr-overlay.active { display: flex; }
        .scan-line { width: 80%; height: 3px; background: #F4D03F; box-shadow: 0 0 15px #F4D03F; animation: scan 2s infinite; }
        @keyframes scan { 0%, 100% { transform: translateY(-120px); opacity: 0; } 50% { transform: translateY(120px); opacity: 1; } }
        .toast { position: fixed; top: 60px; left: 50%; transform: translateX(-50%) translateY(-100px); background: #1a1a1a; color: white; padding: 14px 28px; border-radius: 30px; font-weight: 700; opacity: 0; transition: all 0.3s; z-index: 200; }
        .toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }
        .stat-card { background: white; border-radius: 20px; padding: 16px; min-width: 100px; }
        .bank-icon { width: 44px; height: 44px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 11px; }
        .app-badge { display: flex; align-items: center; gap: 8px; background: white; border-radius: 16px; padding: 8px 14px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">
    <div class="phone">
        <div class="screen">
            
            <!-- DASHBOARD -->
            <div id="dashboard" class="page active">
                <!-- Header -->
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <p class="text-gray-500 text-sm">Good afternoon <span class="text-xl">‚òÄÔ∏è</span></p>
                        <p class="text-2xl font-bold text-gray-800">Boss</p>
                    </div>
                    <div class="avatar" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">B</div>
                </div>

                <!-- Total Tracked -->
                <div class="card bg-gradient-to-br from-gray-800 to-gray-900 p-6 mb-5 text-white">
                    <p class="text-gray-400 text-sm mb-1">üí∞ Total Money Tracked</p>
                    <p class="text-4xl font-extrabold mb-2">$45,230.50</p>
                    <p class="text-gray-400 text-xs">Across all your apps & receipts</p>
                </div>

                <!-- Stats -->
                <div class="flex gap-3 mb-6">
                    <div class="stat-card flex-1">
                        <p class="text-gray-400 text-xs mb-1">üì§ Sent</p>
                        <p class="text-xl font-bold text-pink-500">$8,234</p>
                    </div>
                    <div class="stat-card flex-1">
                        <p class="text-gray-400 text-xs mb-1">üì• Received</p>
                        <p class="text-xl font-bold text-green-500">$12,500</p>
                    </div>
                    <div class="stat-card flex-1">
                        <p class="text-gray-400 text-xs mb-1">üìù Logs</p>
                        <p id="txCount" class="text-xl font-bold text-gray-800">0</p>
                    </div>
                </div>

                <!-- QUICK LOG -->
                <p class="text-sm font-bold text-gray-600 mb-4">‚ö° QUICK LOG</p>
                
                <div class="flex justify-center gap-6 mb-6">
                    <div class="flex flex-col items-center">
                        <button onclick="startVoiceFlow()" class="btn-mic mb-2">
                            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path></svg>
                        </button>
                        <p class="text-xs font-bold text-gray-700">"Hey Gege"</p>
                        <p class="text-xs text-gray-400">Screen capture</p>
                    </div>

                    <div class="flex flex-col items-center">
                        <button onclick="startCameraFlow()" class="btn-camera mb-2">
                            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                        </button>
                        <p class="text-xs font-bold text-gray-700">Camera</p>
                        <p class="text-xs text-gray-400">Receipt scan</p>
                    </div>

                    <div class="flex flex-col items-center">
                        <button onclick="openAddModal()" class="btn-mic mb-2" style="background: linear-gradient(135deg, #A0E8B8 0%, #B8F5C8 100%);">
                            <svg class="w-8 h-8 text-gray-800" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
                        </button>
                        <p class="text-xs font-bold text-gray-700">Manual</p>
                        <p class="text-xs text-gray-400">Type entry</p>
                    </div>
                </div>

                <!-- TRACKED FROM - With Bank Logos -->
                <p class="text-sm font-bold text-gray-600 mb-3">üì± TRACKED FROM</p>
                
                <div class="flex gap-3 mb-6 overflow-x-auto pb-2">
                    <!-- BPI -->
                    <div class="app-badge">
                        <div class="bank-icon" style="background: #8B0000; color: white;">BPI</div>
                        <span class="text-sm font-bold text-gray-700">BPI</span>
                    </div>
                    
                    <!-- GCash -->
                    <div class="app-badge">
                        <div class="bank-icon" style="background: #005CE6; color: white;">G</div>
                        <span class="text-sm font-bold text-gray-700">GCash</span>
                    </div>
                    
                    <!-- PayPal -->
                    <div class="app-badge">
                        <div class="bank-icon" style="background: #003087; color: white;">PP</div>
                        <span class="text-sm font-bold text-gray-700">PayPal</span>
                    </div>
                    
                    <!-- Maya -->
                    <div class="app-badge">
                        <div class="bank-icon" style="background: #00D632; color: white;">M</div>
                        <span class="text-sm font-bold text-gray-700">Maya</span>
                    </div>
                    
                    <!-- Wise -->
                    <div class="app-badge">
                        <div class="bank-icon" style="background: #00B9FF; color: white;">W</div>
                        <span class="text-sm font-bold text-gray-700">Wise</span>
                    </div>
                    
                    <!-- Receipts -->
                    <div class="app-badge">
                        <div class="bank-icon" style="background: #FF6B35; color: white;">üßæ</div>
                        <span class="text-sm font-bold text-gray-700">Receipts</span>
                    </div>
                </div>

                <!-- Recent Logs -->
                <div class="flex justify-between items-center mb-4">
                    <p class="text-lg font-bold text-gray-800">üïê Recent Logs</p>
                    <span class="text-sm font-semibold text-yellow-600 cursor-pointer" onclick="navigate('transactions')">See all ‚Üí</span>
                </div>

                <div id="transactionList" class="space-y-3"></div>
            </div>

            <!-- HISTORY -->
            <div id="transactions" class="page">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <p class="text-gray-500 text-sm">All your tracked</p>
                        <p class="text-2xl font-bold text-gray-800">üìä Transactions</p>
                    </div>
                </div>
                <div id="allTransactions" class="space-y-3"></div>
            </div>

            <!-- VOICE -->
            <div id="voice" class="page">
                <div class="flex flex-col items-center justify-center h-full pt-10">
                    <div class="relative mb-10">
                        <div id="ring1" class="voice-ring hidden"></div>
                        <div id="ring2" class="voice-ring hidden" style="animation-delay: 0.5s"></div>
                        
                        <button id="micBtn" onclick="toggleListening()" class="w-36 h-36 rounded-full bg-gray-800 flex items-center justify-center shadow-2xl relative z-10">
                            <svg id="micIcon" class="w-16 h-16 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path></svg>
                        </button>
                    </div>

                    <p id="voiceText" class="text-2xl font-bold text-gray-800 mb-2">Tap to say "Hey Gege"</p>
                    <p id="voiceSub" class="text-sm text-gray-500 text-center px-8">I'll capture your screen and log the transaction</p>
                </div>
            </div>

            <!-- SETTINGS -->
            <div id="settings" class="page">
                <div class="flex justify-between items-center mb-6"><p class="text-2xl font-bold text-gray-800">‚öôÔ∏è Settings</p></div>

                <div class="card bg-white p-4 mb-4 flex items-center gap-4">
                    <div class="avatar" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">B</div>
                    <div class="flex-1"><p class="font-bold text-gray-800">Boss</p><p class="text-sm text-gray-500">Money Tracker</p></div>
                </div>

                <div class="space-y-3">
                    <button onclick="exportData()" class="card bg-white p-4 w-full flex items-center justify-between">
                        <div class="flex items-center gap-3"><span class="text-2xl">üì§</span><span class="font-bold text-gray-700">Export Data</span></div>
                        <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                    </button>

                    <button onclick="clearData()" class="card bg-red-50 p-4 w-full flex items-center justify-between">
                        <div class="flex items-center gap-3"><span class="text-2xl">üóëÔ∏è</span><span class="font-bold text-red-500">Clear Logs</span></div>
                        <svg class="w-5 h-5 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                    </button>
                </div>

                <p class="text-center text-xs text-gray-400 mt-8">Gege v2.0 ‚Ä¢ AI Money Tracker üöÄ</p>
            </div>

        </div>

        <!-- Bottom Nav -->
        <div class="nav">
            <div class="nav-item active" onclick="navigate('dashboard')"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg></div>
            <div class="nav-item" onclick="navigate('transactions')"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></div>
            <div class="nav-item" onclick="navigate('voice')"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path></svg></div>
            <div class="nav-item" onclick="navigate('settings')"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg></div>
        </div>
    </div>

    <!-- OCR Overlay -->
    <div id="ocrOverlay" class="ocr-overlay">
        <p class="text-yellow-400 text-2xl font-bold mb-2">üß† AI Analyzing</p>
        <p class="text-gray-400 text-sm mb-6">Reading your transaction...</p>
        <div class="w-72 h-48 border-2 border-yellow-400 rounded-2xl relative overflow-hidden mb-6 bg-gray-800"><div class="scan-line"></div></div>
        <p id="ocrText" class="text-white font-semibold">Scanning...</p>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast"><span id="toastMsg"></span></div>

    <script>
        let transactions = JSON.parse(localStorage.getItem('gege_v2')) || [
            { id: '1', type: 'sent', amount: 2500, currency: 'PHP', recipient: 'John D.', app: 'GCash', date: new Date().toISOString() },
            { id: '2', type: 'sent', amount: 45, currency: 'USD', recipient: 'Sarah C.', app: 'PayPal', date: new Date().toISOString() },
            { id: '3', type: 'received', amount: 15000, currency: 'PHP', recipient: 'Boss', app: 'BPI', date: new Date(Date.now() - 86400000).toISOString() },
        ];
        let listening = false;

        const bankColors = {
            'BPI': { bg: '#8B0000', text: 'white' },
            'GCash': { bg: '#005CE6', text: 'white' },
            'PayPal': { bg: '#003087', text: 'white' },
            'Maya': { bg: '#00D632', text: 'white' },
            'Wise': { bg: '#00B9FF', text: 'white' },
            'Card': { bg: '#FF6B35', text: 'white' },
            'Manual': { bg: '#9B59B6', text: 'white' }
        };

        document.addEventListener('DOMContentLoaded', () => {
            renderTransactions();
            updateStats();
        });

        function navigate(page) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(page).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            event.currentTarget.classList.add('active');
            if (page === 'transactions') renderAllTransactions();
        }

        function updateStats() {
            document.getElementById('txCount').textContent = transactions.length;
        }

        function renderTransactions() {
            const list = document.getElementById('transactionList');
            const recent = transactions.slice(0, 4);
            list.innerHTML = recent.map(tx => createTxHTML(tx)).join('');
            updateStats();
        }

        function renderAllTransactions() {
            const list = document.getElementById('allTransactions');
            list.innerHTML = transactions.map(tx => createTxHTML(tx)).join('');
        }

        function createTxHTML(tx) {
            const isSent = tx.type === 'sent';
            const colors = bankColors[tx.app] || { bg: '#666', text: 'white' };
            
            return `
                <div class="card bg-white p-4 flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <div class="bank-icon" style="background: ${colors.bg}; color: ${colors.text};">${tx.app.substring(0,2).toUpperCase()}</div>
                        <div>
                            <p class="font-bold text-gray-800">${tx.app}</p>
                            <p class="text-sm text-gray-500">${isSent ? 'To' : 'From'}: ${tx.recipient}</p>
                            <p class="text-xs text-gray-400">${formatDate(tx.date)}</p>
                        </div>
                    </div>
                    <span class="${isSent ? 'badge-sent' : 'badge-received'}">${isSent ? '-' : '+'}${formatMoney(tx.amount, tx.currency)}</span>
                </div>
            `;
        }

        async function startVoiceFlow() {
            navigate('voice');
            setTimeout(toggleListening, 400);
        }

        async function toggleListening() {
            if (listening) return;
            listening = true;
            
            const btn = document.getElementById('micBtn');
            const icon = document.getElementById('micIcon');
            const text = document.getElementById('voiceText');
            const sub = document.getElementById('voiceSub');
            
            btn.classList.add('bg-yellow-400');
            btn.classList.remove('bg-gray-800');
            icon.classList.remove('text-yellow-400');
            icon.classList.add('text-gray-800');
            document.getElementById('ring1').classList.remove('hidden');
            document.getElementById('ring2').classList.remove('hidden');
            text.textContent = 'Listening...';
            
            await wait(1500);
            text.textContent = 'Yes! üëã';
            sub.textContent = 'Capturing screen...';
            
            await wait(600);
            document.getElementById('ocrOverlay').classList.add('active');
            
            await wait(1500);
            document.getElementById('ocrText').textContent = 'üîç Reading...';
            await wait(1500);
            document.getElementById('ocrText').textContent = '‚úì Found: Sent ‚Ç±2,500 via GCash';
            await wait(1000);
            document.getElementById('ocrOverlay').classList.remove('active');
            
            addTx({ type: 'sent', amount: 2500, currency: 'PHP', recipient: 'Maria S.', app: 'GCash' });
            
            btn.classList.remove('bg-yellow-400');
            btn.classList.add('bg-gray-800');
            icon.classList.add('text-yellow-400');
            icon.classList.remove('text-gray-800');
            document.getElementById('ring1').classList.add('hidden');
            document.getElementById('ring2').classList.add('hidden');
            text.textContent = '‚úì Logged!';
            sub.textContent = 'Sent ‚Ç±2,500 via GCash';
            listening = false;
            
            setTimeout(() => {
                text.textContent = 'Tap to say "Hey Gege"';
                sub.textContent = 'I\'ll capture and log your transaction';
                navigate('dashboard');
            }, 2500);
        }

        async function startCameraFlow() {
            navigate('voice');
            document.getElementById('voiceText').textContent = 'üì∑ Camera Mode';
            document.getElementById('voiceSub').textContent = 'Point at receipt...';
            
            await wait(1500);
            document.getElementById('ocrOverlay').classList.add('active');
            document.getElementById('ocrText').textContent = 'üì∏ Capturing...';
            
            await wait(2000);
            document.getElementById('ocrText').textContent = 'üîç Reading receipt...';
            await wait(1500);
            document.getElementById('ocrText').textContent = '‚úì Found: $47.25 at Starbucks';
            await wait(1000);
            document.getElementById('ocrOverlay').classList.remove('active');
            
            addTx({ type: 'sent', amount: 47.25, currency: 'USD', recipient: 'Starbucks', app: 'Card' });
            
            document.getElementById('voiceText').textContent = '‚úì Receipt Logged!';
            document.getElementById('voiceSub').textContent = '$47.25 at Starbucks';
            
            setTimeout(() => navigate('dashboard'), 2500);
        }

        function openAddModal() {
            const type = confirm('Did you SEND money? (OK=Send, Cancel=Receive)') ? 'sent' : 'received';
            const amount = prompt('Amount:');
            if (!amount || isNaN(amount)) return;
            const currency = prompt('Currency:', 'PHP') || 'PHP';
            const recipient = prompt(type === 'sent' ? 'To:' : 'From:');
            if (!recipient) return;
            const app = prompt('App (GCash/PayPal/BPI/etc):', 'GCash') || 'Manual';
            addTx({ type, amount: parseFloat(amount), currency: currency.toUpperCase(), recipient, app });
            showToast('‚úì Transaction logged!');
        }

        function addTx(data) {
            const tx = { id: Date.now().toString(), ...data, date: new Date().toISOString() };
            transactions.unshift(tx);
            localStorage.setItem('gege_v2', JSON.stringify(transactions));
            renderTransactions();
            showToast('‚úì Saved!');
        }

        function formatMoney(amount, currency) {
            const symbols = { USD: '$', PHP: '‚Ç±', CAD: 'CA$', EUR: '‚Ç¨' };
            return (symbols[currency] || '$') + amount.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        }

        function formatDate(date) {
            const d = new Date(date);
            const now = new Date();
            const diff = now - d;
            if (diff < 60000) return 'Just now';
            if (diff < 3600000) return Math.floor(diff/60000) + 'm ago';
            if (diff < 86400000) return Math.floor(diff/3600000) + 'h ago';
            if (diff < 172800000) return 'Yesterday';
            return d.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        }

        function wait(ms) { return new Promise(r => setTimeout(r, ms)); }

        function showToast(msg) {
            const toast = document.getElementById('toast');
            document.getElementById('toastMsg').textContent = msg;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        function exportData() {
            const data = JSON.stringify(transactions, null, 2);
            const blob = new Blob([data], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'gege-logs.json';
            a.click();
            showToast('üì§ Exported!');
        }

        function clearData() {
            if (confirm('Delete all logs?')) {
                transactions = [];
                localStorage.setItem('gege_v2', JSON.stringify(transactions));
                renderTransactions();
                showToast('üóëÔ∏è Cleared!');
            }
        }
    </script>
</body>
</html>
